---
description: アーキテクチャに対してアーキテクト・セキュリティ・性能・運用のペルソナでレビューを実行する
handoffs:
  - label: 実装開始
    agent: speckit.implement
    prompt: アーキテクチャレビューをクリアしました。実装を開始してください
    send: true
  - label: 設計修正
    agent: speckit.plan
    prompt: レビュー指摘に基づいてアーキテクチャを修正してください
---

## ユーザー入力

```text
$ARGUMENTS
```

**使用方法**: `/review-architecture <data-model.mdまたはplan.mdのパス>`

## アウトライン

1. ターゲットファイルの読み込み（data-model.md, plan.md, contracts/）
2. 関連成果物の読み込み（spec.md等）
3. 4つのペルソナでレビューを実行
4. 設計原則のチェック
5. セキュリティ、性能、運用性の評価
6. 判定と推奨事項を出力

## ペルソナ詳細

### アーキテクト
**観点**: 設計原則（SOLID）、拡張性、保守性
**確認項目**:
- **SOLID原則**:
  - [S] 単一責任: クラス/モジュールが1つの責任を持っているか？
  - [O] 開放閉鎖: 拡張に対して開かれ、変更に対して閉じているか？
  - [L] リスコフ置換: サブタイプはスーパータイプを置換可能か？
  - [I] インタフェース分離: インタフェースが適切に分離されているか？
  - [D] 依存性逆転: 高レベルモジュールが低レベルモジュールに依存していないか？
- **拡張性**: 新機能の追加が容易か？
- **保守性**: コードの変更が容易か？
- **モジュール性**: モジュールが適切に分離されているか？

### セキュリティスペシャリスト
**観点**: 脆弱性、認証認可、データ保護
**確認項目**:
- **認証認可**: 適切な認証と認可が実装されるか？
- **データ保護**: 機密データが保護されるか？
- **入力検証**: 全ての入力が検証されるか？
- **SQLインジェクション/XSS**: 脆弱性がないか？
- **暗号化**: データの暗号化が必要か？
- **シークレット管理**: APIキー、認証情報が安全に管理されるか？

### パフォーマンスエンジニア
**観点**: スケーラビリティ、レイテンシ、スループット
**確認項目**:
- **スケーラビリティ**: システムがスケールできるか？
- **レイテンシ**: レイテンシ要件が満たされるか？
- **スループット**: スループット要件が満たされるか？
- **キャッシング**: キャッシング戦略があるか？
- **データベース最適化**: データベースが最適化されるか？
- **非同期処理**: 適切な非同期処理があるか？

### SRE (Site Reliability Engineer)
**観点**: デプロイ、監視、トラブルシューティング
**確認項目**:
- **デプロイ**: デプロイプロセスが自動化されているか？
- **監視**: 監視とアラートがあるか？
- **ログ**: 構造化ログがあるか？
- **トラブルシューティング**: デバッグが容易か？
- **バックアップ**: バックアップと復元があるか？
- **フェイルオーバー**: フェイルオーバー戦略があるか？

## 設計原則チェック

### SOLID原則

| 原則 | 説明 | チェック | 結果 |
|------|------|---------|------|
| S (Single Responsibility) | 単一責任 | 各クラス/モジュールが1つの責任を持つ | [✓/✗] |
| O (Open/Closed) | 開放閉鎖 | 拡張可能で、変更に対して閉じている | [✓/✗] |
| L (Liskov Substitution) | リスコフ置換 | サブタイプがスーパータイプを置換可能 | [✓/✗] |
| I (Interface Segregation) | インタフェース分離 | インタフェースが適切に分離されている | [✓/✗] |
| D (Dependency Inversion) | 依存性逆転 | 依存性が逆転されている | [✓/✗] |

### 設計品質

| 項目 | 評価 | 説明 |
|------|------|------|
| 拡張性 | [1-5] | 1: 低い、5: 高い |
| 保守性 | [1-5] | 1: 低い、5: 高い |
| モジュール性 | [1-5] | 1: 低い、5: 高い |
| 再利用性 | [1-5] | 1: 低い、5: 高い |

## セキュリティ評価

| カテゴリ | 評価 | 説明 |
|---------|------|------|
| 認証認可 | [✓/✗/?] | 実装されるか？ |
| データ保護 | [✓/✗/?] | 保護されるか？ |
| 入力検証 | [✓/✗/?] | 全ての入力が検証されるか？ |
| 脆弱性対策 | [✓/✗/?] | 対策があるか？ |
| シークレット管理 | [✓/✗/?] | 安全に管理されるか？ |

## 性能評価

| カテゴリ | 評価 | 説明 |
|---------|------|------|
| スケーラビリティ | [✓/✗/?] | スケールできるか？ |
| レイテンシ | [✓/✗/?] | 要件を満たすか？ |
| スループット | [✓/✗/?] | 要件を満たすか？ |
| キャッシング | [✓/✗/?] | 戦略があるか？ |
| データベース最適化 | [✓/✗/?] | 最適化されるか？ |

## 運用性評価

| カテゴリ | 評価 | 説明 |
|---------|------|------|
| デプロイ自動化 | [✓/✗/?] | 自動化されているか？ |
| 監視 | [✓/✗/?] | 監視があるか？ |
| 構造化ログ | [✓/✗/?] | ログがあるか？ |
| トラブルシューティング | [✓/✗/?] | 容易か？ |
| バックアップ | [✓/✗/?] | あるか？ |

## 出力形式

```markdown
# アーキテクチャレビュー結果

**対象**: [ファイルのパス]
**レビュー日時**: [日時]

## 判定: GO / CONDITIONAL / NO-GO

[判定の理由]

## Critical Issues

[重大な問題のリスト]

## High Priority Issues

[高優先度問題のリスト]

## Medium Priority Issues

[中優先度問題のリスト]

## 設計原則チェック

### SOLID原則
| 原則 | 結果 | 説明 |
|------|------|------|
| S (単一責任) | [✓/✗] | [説明] |
| O (開放閉鎖) | [✓/✗] | [説明] |
| L (リスコフ置換) | [✓/✗] | [説明] |
| I (インタフェース分離) | [✓/✗] | [説明] |
| D (依存性逆転) | [✓/✗] | [説明] |

### 設計品質
| 項目 | 評価 | 説明 |
|------|------|------|
| 拡張性 | [1-5] | [説明] |
| 保守性 | [1-5] | [説明] |
| モジュール性 | [1-5] | [説明] |
| 再利用性 | [1-5] | [説明] |

## セキュリティ評価
[セキュリティ評価の詳細]

## 性能評価
[性能評価の詳細]

## 運用性評価
[運用性評価の詳細]

## ペルソナ別フィードバック

### アーキテクト
[アーキテクトのフィードバック]

### セキュリティスペシャリスト
[セキュリティスペシャリストのフィードバック]

### パフォーマンスエンジニア
[パフォーマンスエンジニアのフィードバック]

### SRE
[SREのフィードバック]

## 推奨事項
[推奨事項のリスト]
```

## 品質基準

- **GO**: Critical/High問題なし、実装を進めてよい
- **CONDITIONAL**: 軽微な問題あり、修正後に進めてよい
- **NO-GO**: 重大な問題あり、修正が必要

## 次のステップ

- **GO**: `/speckit.implement` または `/swarm` で実装開始
- **CONDITIONAL**: 問題を修正し、再レビュー
- **NO-GO**: アーキテクチャを修正し、再レビュー
